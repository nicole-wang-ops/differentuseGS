(function(){"use strict";var e={8781:function(e,o,t){var n=t(3751),s=t(641);function r(e,o,t,n,r,a){const i=(0,s.g2)("DifferentuseGS3");return(0,s.uX)(),(0,s.Wv)(i,{msg:"Welcome to Your Vue.js App"})}var a=t(33);const i=e=>((0,s.Qi)("data-v-44cde794"),e=e(),(0,s.jt)(),e),c=i((()=>(0,s.Lk)("h1",null,"Google Sheets Data5",-1))),l={key:0},h={key:1},d={key:2},u=i((()=>(0,s.Lk)("h3",null,"Add New Entry",-1))),p=i((()=>(0,s.Lk)("label",{for:"id"},"ID:",-1))),g=i((()=>(0,s.Lk)("label",{for:"name"},"Name:",-1))),f=i((()=>(0,s.Lk)("label",{for:"password"},"Password:",-1)));function w(e,o,t,r,i,w){return(0,s.uX)(),(0,s.CE)("div",null,[c,i.loading?((0,s.uX)(),(0,s.CE)("div",l,"Loading...")):(0,s.Q3)("",!0),i.error?((0,s.uX)(),(0,s.CE)("div",h,(0,a.v_)(i.error),1)):(0,s.Q3)("",!0),i.sheetsData.length?((0,s.uX)(),(0,s.CE)("table",d,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.sheetsData,((e,o)=>((0,s.uX)(),(0,s.CE)("tr",{key:o},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,o)=>((0,s.uX)(),(0,s.CE)("td",{key:o},(0,a.v_)(e),1)))),128))])))),128))])):(0,s.Q3)("",!0),u,(0,s.Lk)("div",null,[p,(0,s.bo)((0,s.Lk)("input",{id:"id","onUpdate:modelValue":o[0]||(o[0]=e=>i.newEntry.id=e),placeholder:"Enter ID"},null,512),[[n.Jo,i.newEntry.id]])]),(0,s.Lk)("div",null,[g,(0,s.bo)((0,s.Lk)("input",{id:"name","onUpdate:modelValue":o[1]||(o[1]=e=>i.newEntry.name=e),placeholder:"Enter Name"},null,512),[[n.Jo,i.newEntry.name]])]),(0,s.Lk)("div",null,[f,(0,s.bo)((0,s.Lk)("input",{id:"password","onUpdate:modelValue":o[2]||(o[2]=e=>i.newEntry.password=e),placeholder:"Enter Password"},null,512),[[n.Jo,i.newEntry.password]])]),(0,s.Lk)("button",{onClick:o[3]||(o[3]=(...e)=>w.addRow&&w.addRow(...e))},"Add New Row")])}t(4603),t(7566),t(8721);var k={data(){return{sheetsData:[],loading:!1,error:null,accessToken:null,newEntry:{id:"",name:"",password:""}}},mounted(){this.initClient()},methods:{initClient(){const e=localStorage.getItem("refresh_token");console.log("检查是否有 refresh_token:",e),e?(console.log("找到 refresh_token，尝试获取 access_token"),this.fetchAccessToken(e)):(console.log("没有找到 refresh_token，重定向到 Google 登录页面"),this.redirectToGoogleLogin())},redirectToGoogleLogin(){const e="562278447012-g8107er0h2v1s3nidqe4svp3dd6o16i2.apps.googleusercontent.com",o="https://nicole-wang-ops.github.io/testdifuG/",t="https://www.googleapis.com/auth/spreadsheets",n=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${e}&redirect_uri=${o}&response_type=code&scope=${t}&access_type=offline&prompt=consent`;console.log("重定向到:",n),window.location.href=n},async fetchAccessToken(e){try{const o=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:"562278447012-g8107er0h2v1s3nidqe4svp3dd6o16i2.apps.googleusercontent.com",client_secret:"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",refresh_token:e,grant_type:"refresh_token"})}),t=await o.json();console.log("获取 access_token 的响应:",t),t.access_token?(this.accessToken=t.access_token,localStorage.setItem("access_token",t.access_token),console.log("access_token 获取成功并存储在 localStorage 中"),this.fetchGoogleSheetsData()):(this.error="Failed to retrieve access token.",console.log("获取 access_token 失败:",t))}catch(o){this.error="Error fetching access token: "+o.message,console.log("获取 access_token 时发生错误:",o)}},fetchGoogleSheetsData(){if(!this.accessToken)return void(this.error="Access token is required");this.loading=!0;const e="1p0VikCs8qqlMNTuWhHkZNrvFj913wqLy5N5rSgZwNTU",o="Sheet1!A1:C1000";fetch(`https://sheets.googleapis.com/v4/spreadsheets/${e}/values/${o}?access_token=${this.accessToken}`).then((e=>e.json())).then((e=>{this.sheetsData=e.values||[],this.loading=!1,console.log("成功获取 Google Sheets 数据:",this.sheetsData)})).catch((e=>{this.error="Error fetching data: "+e.message,this.loading=!1,console.log("获取 Google Sheets 数据时发生错误:",e)}))},addRow(){if(!this.accessToken)return void(this.error="Access token is required");if(!this.newEntry.id||!this.newEntry.name||!this.newEntry.password)return void(this.error="All fields are required");const e="1p0VikCs8qqlMNTuWhHkZNrvFj913wqLy5N5rSgZwNTU",o="Sheet1",t={values:[[this.newEntry.id,this.newEntry.name,this.newEntry.password]]};fetch(`https://sheets.googleapis.com/v4/spreadsheets/${e}/values/${o}:append?valueInputOption=RAW&insertDataOption=INSERT_ROWS`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.accessToken}`},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{this.fetchGoogleSheetsData(),this.newEntry.id="",this.newEntry.name="",this.newEntry.password="",console.log("成功添加新行:",e)})).catch((e=>{this.error="Error adding row: "+e.message,console.log("添加新行时发生错误:",e)}))}}},v=t(6262);const y=(0,v.A)(k,[["render",w],["__scopeId","data-v-44cde794"]]);var m=y,E={name:"App",components:{DifferentuseGS3:m}};const _=(0,v.A)(E,[["render",r]]);var b=_;(0,n.Ef)(b).mount("#app")}},o={};function t(n){var s=o[n];if(void 0!==s)return s.exports;var r=o[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(o,n,s,r){if(!n){var a=1/0;for(h=0;h<e.length;h++){n=e[h][0],s=e[h][1],r=e[h][2];for(var i=!0,c=0;c<n.length;c++)(!1&r||a>=r)&&Object.keys(t.O).every((function(e){return t.O[e](n[c])}))?n.splice(c--,1):(i=!1,r<a&&(a=r));if(i){e.splice(h--,1);var l=s();void 0!==l&&(o=l)}}return o}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[n,s,r]}}(),function(){t.d=function(e,o){for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){var e={524:0};t.O.j=function(o){return 0===e[o]};var o=function(o,n){var s,r,a=n[0],i=n[1],c=n[2],l=0;if(a.some((function(o){return 0!==e[o]}))){for(s in i)t.o(i,s)&&(t.m[s]=i[s]);if(c)var h=c(t)}for(o&&o(n);l<a.length;l++)r=a[l],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(h)},n=self["webpackChunkvue_googlesheets"]=self["webpackChunkvue_googlesheets"]||[];n.forEach(o.bind(null,0)),n.push=o.bind(null,n.push.bind(n))}();var n=t.O(void 0,[504],(function(){return t(8781)}));n=t.O(n)})();
//# sourceMappingURL=app.002ab3a1.js.map